"use strict";(globalThis["webpackChunkqPhotobooth"]=globalThis["webpackChunkqPhotobooth"]||[]).push([[759],{7343:(e,i,r)=>{r.d(i,{Z:()=>E});var t=r(9835),a=r(6970);const n={class:"q-mr-sm"},l={class:"q-mr-sm"},s={class:"q-gutter-sm"};function o(e,i,r,o,d,m){const c=(0,t.up)("q-btn"),g=(0,t.up)("q-space"),u=(0,t.up)("q-icon"),h=(0,t.up)("q-toolbar"),p=(0,t.up)("q-linear-progress"),S=(0,t.up)("q-header"),v=(0,t.up)("q-drawer"),w=(0,t.up)("q-carousel-slide"),I=(0,t.up)("q-carousel"),y=(0,t.up)("vue-qrcode"),f=(0,t.up)("q-page-sticky"),T=(0,t.up)("q-page-container"),b=(0,t.up)("q-layout"),q=(0,t.Q2)("close-popup"),Z=(0,t.Q2)("touch-swipe");return(0,t.wg)(),(0,t.j4)(b,{view:"hhh Lpr ffr",onClick:m.abortTimer},{default:(0,t.w5)((()=>[(0,t.Wm)(S,{elevated:"",class:"bg-primary text-white"},{default:(0,t.w5)((()=>[(0,t.Wm)(h,null,{default:(0,t.w5)((()=>[(0,t.wy)((0,t.Wm)(c,{flat:"",class:"q-mr-sm",icon:"delete",label:"Delete",onClick:i[0]||(i[0]=e=>m.deleteImage(o.currentSlideId))},null,512),[[q]]),(0,t.Wm)(c,{flat:"",class:"q-mr-sm",icon:"download",label:"Download",onClick:i[1]||(i[1]=e=>{o.openURL(o.store.gallery.images[o.currentSlideIndex]["full"])})}),(0,t.Wm)(c,{flat:"",class:"q-mr-sm",icon:"print",label:"Print"}),(0,t.Wm)(c,{flat:"",class:"q-mr-sm",icon:"filter",label:"Filter",onClick:o.toggleRightDrawer},null,8,["onClick"]),(0,t.Wm)(g),(0,t._)("div",n,[(0,t.Wm)(u,{name:"tag"}),(0,t._)("span",null,(0,a.zw)(o.currentSlideIndex+1)+" of "+(0,a.zw)(o.store.gallery.images.length)+" total",1)]),(0,t.Wm)(g),(0,t._)("div",l,[(0,t.Wm)(u,{name:"image"}),(0,t.Uk)(" "+(0,a.zw)(o.store.gallery.images[o.currentSlideIndex]["caption"]),1)]),(0,t.Wm)(g),(0,t.wy)((0,t.Wm)(c,{dense:"",flat:"",icon:"close"},null,512),[[q]])])),_:1}),d.displayLinearProgressBar&&d.remainingSeconds>0?((0,t.wg)(),(0,t.j4)(p,{key:0,value:d.remainingSecondsNormalized,"animation-speed":"200",color:"grey"},null,8,["value"])):(0,t.kq)("",!0)])),_:1}),(0,t.Wm)(v,{modelValue:o.rightDrawerOpen,"onUpdate:modelValue":i[2]||(i[2]=e=>o.rightDrawerOpen=e),side:"right",elevated:"",overlay:""},{default:(0,t.w5)((()=>[(0,t.Uk)(" FILTER previews here ")])),_:1},8,["modelValue"]),(0,t.Wm)(T,{class:"q-pa-none galleryimagedetail full-height"},{default:(0,t.w5)((()=>[(0,t.wy)(((0,t.wg)(),(0,t.j4)(I,{class:"bg-image",style:{width:"100%",height:"100%"},"control-type":"flat","control-color":"primary",swipeable:"",animated:"",modelValue:o.currentSlideId,"onUpdate:modelValue":i[3]||(i[3]=e=>o.currentSlideId=e),thumbnails:"",autoplay:o.autoplay,draggable:"false",arrows:"","transition-prev":"slide-right","transition-next":"slide-left",onTransition:i[4]||(i[4]=(e,i)=>{o.currentSlideIndex=o.store.gallery.images.findIndex((i=>i.id===e)),m.abortTimer()})},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(m.slicedImages,(e=>((0,t.wg)(),(0,t.j4)(w,{"img-src":e.preview,key:e.id,name:e.id},null,8,["img-src","name"])))),128))])),_:1},8,["modelValue","autoplay"])),[[Z,o.handleSwipeDown,void 0,{mouse:!0,down:!0}]]),(0,t.Wm)(f,{position:"top-right",offset:[30,30]},{default:(0,t.w5)((()=>[(0,t._)("div",s,[(0,t.Wm)(y,{type:"image/png",tag:"svg",margin:2,width:200,"error-correction-level":"low",color:{dark:"#111111",light:"#EEEEEE"},value:m.getImageQrData()},null,8,["value"])])])),_:1})])),_:1})])),_:1},8,["onClick"])}r(8964),r(9665);var d=r(528),m=r(499),c=r(7575),g=r(6694),u=r(3752);const h={props:{indexSelected:{type:Number,required:!0}},computed:{slicedImages(){this.store.gallery.images.length;var e=Math.max(0,this.currentSlideIndex-2),i=Math.max(0,this.currentSlideIndex+3);return this.store.gallery.images.slice(e,i)}},beforeCreate(){console.log(this.indexSelected),this.currentSlideIndex=this.indexSelected,this.currentSlideId=this.store.gallery.images[this.indexSelected].id},data(){return{intervalTimerId:null,remainingSeconds:0,remainingSecondsNormalized:0,displayLinearProgressBar:!0}},setup(){const e=(0,c.h)(),i=(0,g.R)(),r=(0,m.iH)(!1);return{store:e,uiSettingsStore:i,openURL:u.Z,fabRight:(0,m.iH)(!1),currentSlideId:(0,m.iH)(""),currentSlideIndex:(0,m.iH)(0),autoplay:(0,m.iH)(!1),showFilterDialog:(0,m.iH)(!1),rightDrawerOpen:r,toggleRightDrawer(){r.value=!r.value},handleSwipeDown({evt:e}){console.log("TODO: add method to close dialog programmatically")}}},components:{VueQrcode:d.ZP},mounted(){this.startTimer()},beforeUnmount(){clearInterval(this.intervalTimerId)},methods:{deleteImage(e){this.$api.get("/mediacollection/delete",{params:{image_id:e}}).then((e=>{console.log(e),this.store.gallery.images.splice(this.currentSlideIndex,1)})).catch((e=>console.log(e)))},getImageDetail(e,i="thumbnail"){return this.store.gallery.images[e][i]},getImageQrData(){const e=String(this.uiSettingsStore.uiSettings.EXT_DOWNLOAD_URL).replace("{filename}",this.store.gallery.images[this.currentSlideIndex]["filename"]);return e},abortTimer(){clearInterval(this.intervalTimerId),this.remainingSeconds=0,this.remainingSecondsNormalized=0},startTimer(){var e=this.uiSettingsStore.uiSettings["AUTOCLOSE_NEW_ITEM_ARRIVED"];console.log(`starting newitemarrived timer, duration=${e}`),this.remainingSeconds=e,this.intervalTimerId=setInterval((()=>{this.remainingSecondsNormalized=this.remainingSeconds/e,this.remainingSeconds-=.05,this.remainingSeconds<=0&&(clearInterval(this.intervalTimerId),this.$router.push({path:"/"}))}),50)}}};var p=r(1639),S=r(7605),v=r(6602),w=r(1663),I=r(8879),y=r(136),f=r(2857),T=r(8289),b=r(906),q=r(2133),Z=r(7052),_=r(1694),k=r(627),D=r(2146),x=r(4871),W=r(9984),Q=r.n(W);const C=(0,p.Z)(h,[["render",o],["__scopeId","data-v-ce07d0dc"]]),E=C;Q()(h,"components",{QLayout:S.Z,QHeader:v.Z,QToolbar:w.Z,QBtn:I.Z,QSpace:y.Z,QIcon:f.Z,QLinearProgress:T.Z,QDrawer:b.Z,QPageContainer:q.Z,QCarousel:Z.Z,QCarouselSlide:_.Z,QPageSticky:k.Z}),Q()(h,"directives",{ClosePopup:D.Z,TouchSwipe:x.Z})},3759:(e,i,r)=>{r.r(i),r.d(i,{default:()=>p});var t=r(9835);function a(e,i,r,a,n,l){const s=(0,t.up)("q-linear-progress"),o=(0,t.up)("gallery-image-detail"),d=(0,t.up)("q-page");return(0,t.wg)(),(0,t.j4)(d,{class:"q-pa-none fullscreen",onClick:l.abortTimer},{default:(0,t.w5)((()=>[n.displayLinearProgressBar?((0,t.wg)(),(0,t.j4)(s,{key:0,value:n.remainingSecondsNormalized,"animation-speed":"200"},null,8,["value"])):(0,t.kq)("",!0),(0,t.Wm)(o,{indexSelected:0,style:{height:"100%"}})])),_:1},8,["onClick"])}r(9665);var n=r(7575),l=r(6694),s=r(7343);const o={components:{GalleryImageDetail:s.Z},data(){return{intervalTimerId:null,remainingSeconds:0,remainingSecondsNormalized:0,displayLinearProgressBar:!0}},setup(){const e=(0,n.h)(),i=(0,l.R)();return{store:e,uiSettingsStore:i,GalleryImageDetail:s.Z}},mounted(){this.startTimer()},beforeUnmount(){clearInterval(this.intervalTimerId)},methods:{abortTimer(){clearInterval(this.intervalTimerId),this.remainingSeconds=0,this.remainingSecondsNormalized=0},startTimer(){var e=this.uiSettingsStore.uiSettings["AUTOCLOSE_NEW_ITEM_ARRIVED"];console.log(`starting newitemarrived timer, duration=${e}`),this.remainingSeconds=e,this.intervalTimerId=setInterval((()=>{this.remainingSecondsNormalized=this.remainingSeconds/e,this.remainingSeconds-=.05,this.remainingSeconds<=0&&(clearInterval(this.intervalTimerId),this.$router.push({path:"/"}))}),50)}}};var d=r(1639),m=r(9885),c=r(8289),g=r(9984),u=r.n(g);const h=(0,d.Z)(o,[["render",a]]),p=h;u()(o,"components",{QPage:m.Z,QLinearProgress:c.Z})}}]);