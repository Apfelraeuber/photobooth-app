import{G as y,Q as k}from"./GalleryImageDetail.caaa44b0.js";import{at as P,aL as q,C,r as _,O as S,c as m,h,ab as M,af as B,H as G,_ as Q,a1 as j,x as E,aa as V,y as L,q as l,z as p,A as v,t as c,F as N,an as H,j as g,ah as O,ai as R,Z as b,aM as T,aN as A}from"./index.9cd9a530.js";import{Q as F}from"./QPage.5f2aaea3.js";import"./QSpace.4e0d9895.js";import"./QHeader.ff1f132e.js";import"./QLayout.f1bdb81a.js";import"./open-url.f2cae477.js";import"./use-panel.892d81b1.js";import"./selection.255d8afd.js";import"./format.2a3572e1.js";import"./QPageSticky.5ef7a90e.js";const I={threshold:0,root:null,rootMargin:"0px"};function D(e,t,o){let i,a,n;typeof o=="function"?(i=o,a=I,n=t.cfg===void 0):(i=o.handler,a=Object.assign({},I,o.cfg),n=t.cfg===void 0||q(t.cfg,a)===!1),t.handler!==i&&(t.handler=i),n===!0&&(t.cfg=a,t.observer!==void 0&&t.observer.unobserve(e),t.observer=new IntersectionObserver(([s])=>{if(typeof t.handler=="function"){if(s.rootBounds===null&&document.body.contains(e)===!0){t.observer.unobserve(e),t.observer.observe(e);return}(t.handler(s,t.observer)===!1||t.once===!0&&s.isIntersecting===!0)&&w(e)}},a),t.observer.observe(e))}function w(e){const t=e.__qvisible;t!==void 0&&(t.observer!==void 0&&t.observer.unobserve(e),delete e.__qvisible)}var U=P({name:"intersection",mounted(e,{modifiers:t,value:o}){const i={once:t.once===!0};D(e,i,o),e.__qvisible=i},updated(e,t){const o=e.__qvisible;o!==void 0&&D(e,o,t.value)},beforeUnmount:w}),z=C({name:"QIntersection",props:{tag:{type:String,default:"div"},once:Boolean,transition:String,transitionDuration:{type:[String,Number],default:300},ssrPrerender:Boolean,margin:String,threshold:[Number,Array],root:{default:null},disable:Boolean,onVisibility:Function},setup(e,{slots:t,emit:o}){const i=_(S.value===!0?e.ssrPrerender:!1),a=m(()=>e.root!==void 0||e.margin!==void 0||e.threshold!==void 0?{handler:d,cfg:{root:e.root,rootMargin:e.margin,threshold:e.threshold}}:d),n=m(()=>e.disable!==!0&&(S.value!==!0||e.once!==!0||e.ssrPrerender!==!0)),s=m(()=>[[U,a.value,void 0,{once:e.once}]]),r=m(()=>`--q-transition-duration: ${e.transitionDuration}ms`);function d(u){i.value!==u.isIntersecting&&(i.value=u.isIntersecting,e.onVisibility!==void 0&&o("visibility",i.value))}function f(){if(i.value===!0)return[h("div",{key:"content",style:r.value},G(t.default))];if(t.hidden!==void 0)return[h("div",{key:"hidden",style:r.value},t.hidden())]}return()=>{const u=e.transition?[h(M,{name:"q-transition--"+e.transition},f)]:f();return B(e.tag,{class:"q-intersection"},u,"main",n.value,()=>s.value)}}});const Y={components:{GalleryImageDetail:y},setup(){const e=j(),t=E(),o=V();return{store:e,uiSettingsStore:t,mediacollectionStore:o,GalleryImageDetail:y,indexSelected:_(null),showImageDetail:_(!1)}},computed:{itemId(){return this.$route.params.id},isGalleryEmpty(){return this.mediacollectionStore.collection_number_of_items==0}},mounted(){},watch:{itemId(e){const t=this.mediacollectionStore.getIndexOfItemId(e);t==-1?console.error(`image id not found ${e}`):this.openPic(t)}},methods:{getImageDetail(e,t="thumbnail"){return this.mediacollectionStore.collection[e][t]},openPic(e){this.indexSelected=e,this.showImageDetail=!0}}},x=e=>(T("data-v-47e39c44"),e=e(),A(),e),Z={key:0,class:"row justify-center q-gutter-sm"},J={key:0},K={key:1},W=x(()=>b("div",{style:{"padding-bottom":"100%"}},null,-1)),X={class:"absolute-full"},$=["src"],ee=["innerHTML"];function te(e,t,o,i,a,n){const s=L("gallery-image-detail");return l(),p(F,{padding:""},{default:v(()=>[n.isGalleryEmpty?(l(),c("div",{key:1,innerHTML:i.uiSettingsStore.uiSettings.GALLERY_EMPTY_MSG},null,8,ee)):(l(),c("div",Z,[(l(!0),c(N,null,H(this.mediacollectionStore.collection,(r,d)=>(l(),p(z,{key:r.id,once:"",class:"preview-item"},{default:v(()=>[g(R,{class:"q-ma-sm",onClick:f=>n.openPic(d)},{default:v(()=>[r.media_type!="video"?(l(),c("div",J,[g(k,{src:n.getImageDetail(d),loading:"eager","no-transition":"","no-spinner":"",ratio:1,class:"rounded-borders"},null,8,["src"])])):(l(),c("div",K,[W,b("div",X,[b("video",{style:{width:"100%",height:"100%","object-fit":"cover","object-position":"50% 50%"},autoplay:"",loop:"",muted:"",playsinline:"",src:n.getImageDetail(d),class:"rounded-borders"},null,8,$)])]))]),_:2},1032,["onClick"])]),_:2},1024))),128))])),g(O,{"transition-show":"jump-up","transition-hide":"jump-down",modelValue:i.showImageDetail,"onUpdate:modelValue":t[1]||(t[1]=r=>i.showImageDetail=r),maximized:""},{default:v(()=>[g(s,{onCloseEvent:t[0]||(t[0]=r=>i.showImageDetail=!1),itemRepository:this.mediacollectionStore.collection,indexSelected:i.indexSelected,class:"full-height"},null,8,["itemRepository","indexSelected"])]),_:1},8,["modelValue"])]),_:1})}var ve=Q(Y,[["render",te],["__scopeId","data-v-47e39c44"]]);export{ve as default};
