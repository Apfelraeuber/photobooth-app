"use strict";(globalThis["webpackChunkphotobooth_app_frontend"]=globalThis["webpackChunkphotobooth_app_frontend"]||[]).push([[720],{77340:(e,l,a)=>{a.r(l),a.d(l,{default:()=>S});var t=a(92444),o=a(74044),n=a(264);const i={class:"q-pa-md"},r=["innerHTML"],s=["innerHTML"],d=["onClick"];function c(e,l,a,c,u,p){const f=(0,t.E1)("q-breadcrumbs-el"),_=(0,t.E1)("q-breadcrumbs"),m=(0,t.E1)("q-card-section"),g=(0,t.E1)("q-input"),b=(0,t.E1)("q-btn"),E=(0,t.E1)("q-card-actions"),h=(0,t.E1)("q-card"),L=(0,t.E1)("q-dialog"),w=(0,t.E1)("q-uploader"),y=(0,t.E1)("q-icon"),Q=(0,t.E1)("q-td"),v=(0,t.E1)("q-table"),C=(0,t.E1)("q-page"),T=(0,t.iS)("close-popup");return(0,t.Wz)(),(0,t.Az)(C,{padding:""},{default:(0,t.Ql)((()=>[(0,t.QD)("div",i,[(0,t.K2)(_,{gutter:"sm",style:{cursor:"pointer"}},{default:(0,t.Ql)((()=>[(0,t.K2)(f,{label:e.$t("TITLE_FILES_WORKING_DIR"),icon:"home",onClick:l[0]||(l[0]=e=>c.onBreadcrumbClick(-1))},null,8,["label"]),((0,t.Wz)(!0),(0,t.An)(t.ae,null,(0,t.mi)(c.breadcrumbs,((e,l)=>((0,t.Wz)(),(0,t.Az)(f,{key:l,onClick:e=>c.onBreadcrumbClick(l)},{default:(0,t.Ql)((()=>[(0,t.mY)((0,o.WA)(e),1)])),_:2},1032,["onClick"])))),128))])),_:1}),(0,t.K2)(L,{modelValue:c.dialog_create_new_folder,"onUpdate:modelValue":l[4]||(l[4]=e=>c.dialog_create_new_folder=e)},{default:(0,t.Ql)((()=>[(0,t.K2)(h,{style:{"min-width":"350px"}},{default:(0,t.Ql)((()=>[(0,t.K2)(m,null,{default:(0,t.Ql)((()=>[(0,t.QD)("div",{class:"text-h6",innerHTML:e.$t("TITLE_FILES_NEW_FOLDER_DIALOG")},null,8,r)])),_:1}),(0,t.K2)(m,{class:"q-pt-none"},{default:(0,t.Ql)((()=>[(0,t.K2)(g,{dense:"",modelValue:c.new_folder_name,"onUpdate:modelValue":l[1]||(l[1]=e=>c.new_folder_name=e),autofocus:"",onKeyup:l[2]||(l[2]=(0,n.jj)((e=>{c.createNewFolder(c.new_folder_name),c.dialog_create_new_folder=!1}),["enter"]))},null,8,["modelValue"])])),_:1}),(0,t.K2)(E,{align:"right",class:"text-primary"},{default:(0,t.Ql)((()=>[(0,t.wt)((0,t.K2)(b,{flat:"",label:e.$t("BTN_LABEL_CANCEL")},null,8,["label"]),[[T]]),(0,t.wt)((0,t.K2)(b,{flat:"",label:e.$t("BTN_LABEL_FILES_CREATE_NEW_FOLDER"),onClick:l[3]||(l[3]=e=>c.createNewFolder(c.new_folder_name))},null,8,["label"]),[[T]])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,t.K2)(L,{modelValue:c.dialog_upload_files,"onUpdate:modelValue":l[7]||(l[7]=e=>c.dialog_upload_files=e)},{default:(0,t.Ql)((()=>[(0,t.K2)(h,{style:{"min-width":"350px"}},{default:(0,t.Ql)((()=>[(0,t.K2)(m,null,{default:(0,t.Ql)((()=>[(0,t.QD)("div",{class:"text-h6",innerHTML:e.$t("TITLE_FILES_UPLOAD_FILES_DIALOG")},null,8,s)])),_:1}),(0,t.K2)(m,{class:"q-pt-none"},{default:(0,t.Ql)((()=>[(0,t.K2)(w,{label:"Upload Files",url:"/admin/files/file/upload","form-fields":[{name:"upload_target_folder",value:c.folder_current}],"field-name":"uploaded_files",batch:"",multiple:"",onFinish:l[5]||(l[5]=e=>c.getFolderContent(c.folder_current)),onUploaded:l[6]||(l[6]=e=>c.dialog_upload_files=!1)},null,8,["form-fields"])])),_:1}),(0,t.K2)(E,{align:"right",class:"text-primary"},{default:(0,t.Ql)((()=>[(0,t.wt)((0,t.K2)(b,{flat:"",label:"Cancel"},null,512),[[T]])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,t.K2)(v,{class:"full-height",flat:"",bordered:"",title:"File Browser",pagination:c.pagination,rows:c.folder_rows,filter:c.filter,columns:c.folder_columns,color:"primary","row-key":"filepath",dense:"",loading:c.folder_loading,selection:"multiple",selected:c.selected,"onUpdate:selected":l[13]||(l[13]=e=>c.selected=e),"virtual-scroll":"","rows-per-page-options":[0]},{"body-cell-type":(0,t.Ql)((e=>[(0,t.K2)(Q,{props:e},{default:(0,t.Ql)((()=>[e.value?((0,t.Wz)(),(0,t.Az)(y,{key:0,name:"folder"})):((0,t.Wz)(),(0,t.Az)(y,{key:1,name:"description"}))])),_:2},1032,["props"])])),"body-cell-name":(0,t.Ql)((e=>[(0,t.K2)(Q,{props:e,style:{cursor:"pointer"}},{default:(0,t.Ql)((()=>[(0,t.QD)("div",{onClick:l=>c.onNameClick(e.row)},(0,o.WA)(e.value),9,d)])),_:2},1032,["props"])])),"top-left":(0,t.Ql)((()=>[(0,t.QD)("div",null,[(0,t.K2)(b,{disable:c.folder_loading,onClick:l[8]||(l[8]=e=>c.dialog_create_new_folder=!0),label:e.$t("BTN_LABEL_FILES_NEW_FOLDER")},null,8,["disable","label"]),(0,t.K2)(b,{class:"q-ml-sm",disable:c.folder_loading,onClick:l[9]||(l[9]=e=>c.dialog_upload_files=!0),label:e.$t("BTN_LABEL_FILES_UPLOAD_FILE")},null,8,["disable","label"]),(0,t.K2)(b,{class:"q-ml-sm",disable:0==c.selected.length,onClick:l[10]||(l[10]=e=>c.getZip(c.selected)),label:e.$t("BTN_LABEL_FILES_DOWNLOAD_ZIP")},null,8,["disable","label"]),(0,t.K2)(b,{class:"q-ml-sm",color:"negative",disable:0==c.selected.length,onClick:l[11]||(l[11]=e=>c.deleteItems(c.selected)),label:e.$t("BTN_LABEL_FILES_DELETE_SELECTED")},null,8,["disable","label"])])])),"top-right":(0,t.Ql)((()=>[(0,t.K2)(g,{borderless:"",dense:"",debounce:"300",modelValue:c.filter,"onUpdate:modelValue":l[12]||(l[12]=e=>c.filter=e),placeholder:e.$t("TEXT_PLACEHOLDER_SEARCH")},{append:(0,t.Ql)((()=>[(0,t.K2)(y,{name:"search"})])),_:1},8,["modelValue","placeholder"])])),_:1},8,["pagination","rows","filter","columns","loading","selected"])])])),_:1})}a(35336),a(51495),a(59344);var u=a(75836),p=(a(56312),a(94088)),f=a(91416);function _(e,l=2){if(!+e)return"0 Bytes";const a=1024,t=l<0?0:l,o=["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],n=Math.floor(Math.log(e)/Math.log(a));return`${parseFloat((e/Math.pow(a,n)).toFixed(t))} ${o[n]}`}const m={watch:{folder_current(e,l){this.getFolderContent(e)}},setup(){const e=(0,f.c)(),l=(0,u.IL)(""),a=(0,u.IL)(!1),o=(0,u.IL)([]),n=[{label:"Type",name:"type",required:!0,align:"left",field:"is_dir",style:"width: 25px"},{label:"Name",name:"name",required:!0,align:"left",field:"name"},{label:"Size",name:"size",required:!0,align:"left",field:"size",format:e=>_(e,0)}],i=(0,u.IL)([]),r=(0,u.IL)(""),s=(0,u.IL)(!1),d=(0,u.IL)(""),c=(0,u.IL)(!1),m=(0,u.IL)({rowsPerPage:0}),g=e=>e.split("/").filter((e=>""!==e)).join("/"),b=(0,t.S6)((()=>{if(!l.value)return[];let e=g(l.value).split("/");return e})),E=e=>{e.is_dir?l.value=e.filepath:(0,p.c)(`/admin/files/file/${e.filepath}`)},h=(e=-1)=>{l.value=b.value.slice(0,e+1).join("/")};async function L(l=""){a.value=!0,i.value=[];let t=await fetch(`/admin/files/list/${l}`,{method:"GET",headers:{"Content-Type":"application/json"}}),n=await t.json();t.ok?o.value=n:(console.error(n),e.notify({message:`Error ${t.status} getting listing. Please check logs.`,caption:"Files",type:"negative"})),a.value=!1}async function w(l=[]){let a=await fetch("/admin/files/zip",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)});if(a.ok){e.notify({message:"Downloading ZIP file",caption:"Files",type:"positive"});let l=await a.blob();var t=window.URL.createObjectURL(l);window.location.assign(t)}else{let l=await a.json();console.error(l),e.notify({message:`Error ${a.status} creating zip. Please check logs.`,caption:"Files",type:"negative"})}}async function y(a=[]){let t=await fetch("/admin/files/delete",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(t.ok)e.notify({message:"Selected items deleted.",caption:"Files",type:"positive"});else{let l=await t.json();console.error(l),e.notify({message:`Error ${t.status} deleting items. Please check logs.`,caption:"Files",type:"negative"})}L(l.value)}async function Q(a){let t=a;l.value&&(t=l.value+"/"+t),console.log(t);let o=await fetch("/admin/files/folder/new",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),n=await o.json();o.ok?(e.notify({message:`Folder "${a}" created.`,caption:"Files",type:"positive"}),L(l.value)):(console.error(n),e.notify({message:`Error ${o.status} while creating folder. Please check logs.`,caption:"Files",type:"negative"}))}return(0,t.u2)((()=>{L()})),{breadcrumbs:b,folder_current:l,folder_columns:n,folder_rows:o,folder_loading:a,pagination:m,selected:i,filter:r,dialog_create_new_folder:s,new_folder_name:d,dialog_upload_files:c,onNameClick:E,onBreadcrumbClick:h,getFolderContent:L,getZip:w,deleteItems:y,createNewFolder:Q}}};var g=a(68716),b=a(9440),E=a(15232),h=a(15736),L=a(30852),w=a(70608),y=a(71008),Q=a(20540),v=a(66480),C=a(99140),T=a(59600),F=a(49668),I=a(50213),k=a(58120),B=a(81020),K=a(95252),A=a.n(K);const q=(0,g.c)(m,[["render",c]]),S=q;A()(m,"components",{QPage:b.c,QBreadcrumbs:E.c,QBreadcrumbsEl:h.c,QDialog:L.c,QCard:w.c,QCardSection:y.c,QInput:Q.c,QCardActions:v.c,QBtn:C.c,QUploader:T.c,QTable:F.c,QTd:I.c,QIcon:k.c}),A()(m,"directives",{ClosePopup:B.c})}}]);